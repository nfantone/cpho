# This workflow will create a new release using `semantic-release` on each push to `master`
# See https://github.com/semantic-release/semantic-release/blob/master/docs/recipes/github-actions.md

name: Release

on:
  push:
    branches: [master]

jobs:
  release:
    name: semantic release
    runs-on: ubuntu-18.04
    steps:
      - name: checkout master
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
          persist-credentials: false

      - name: setup nodejs
        uses: actions/setup-node@v1
        with:
          node-version: 12

      - name: install dependencies
        run: npm ci

      - name: run sematic-release
        env:
          GIT_AUTHOR_NAME: 'Nicol√°s Fantone'
          GIT_AUTHOR_EMAIL: 'nfantone@gmail.com'
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
          NPM_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: npx -p conventional-changelog-conventionalcommits -p @semantic-release/changelog -p @semantic-release/git -p @semantic-release/npm -p @semantic-release/github -p semantic-release -- semantic-release
